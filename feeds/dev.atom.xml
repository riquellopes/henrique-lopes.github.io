<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Henrique Lopes</title><link href="http://blog.henriquelopes.com.br/" rel="alternate"></link><link href="http://blog.henriquelopes.com.br/feeds/dev.atom.xml" rel="self"></link><id>http://blog.henriquelopes.com.br/</id><updated>2016-01-24T09:11:00-02:00</updated><entry><title>Como criar uma api com nodejs e express</title><link href="http://blog.henriquelopes.com.br/como-criar-uma-api-com-node-js-e-express.html" rel="alternate"></link><updated>2016-01-24T09:11:00-02:00</updated><author><name>Henrique Lopes</name></author><id>tag:blog.henriquelopes.com.br,2016-01-24:como-criar-uma-api-com-node-js-e-express.html</id><summary type="html">&lt;p&gt;Eu sou uma pessoa que gosta de resolver problemas, não criar outros por causa de uma linguagem de programação. O &lt;a href="http://www.desenvolvimentoagil.com.br/scrum/product_owner"&gt;PO&lt;/a&gt; na maioria das vezes não possui competências técnicas para distinguir qual seria a melhor linguagem ou arquitetura para o seu produto. Você que está entrando no mercado agora ou almeja entrar, deve ter esse tipo sapiência. Você também é parte do processo, software é feito por pessoas, e são elas que tomam as decisões. Por que eu quis iniciar esse post com essa pequena explanação? Eu sou um pythonista de coração, e adoro usar, quando tenho a possibilidade de resolver os problemas pythonicamente, mas no meu dia a dia, eu nem sempre o posso. Hoje na stack que temos no &lt;a href="https://www.hotelurbano.com/"&gt;hotelurbano&lt;/a&gt;, temos aplicações em &lt;a href="https://www.python.org"&gt;python&lt;/a&gt;, &lt;a href="https://nodejs.org/en/"&gt;nodejs&lt;/a&gt;, &lt;a href="http://www.scala-lang.org/"&gt;scala&lt;/a&gt;, &lt;a href="https://golang.org"&gt;go&lt;/a&gt;, &lt;a href="https://www.ruby-lang.org/pt/"&gt;ruby&lt;/a&gt; e &lt;a href="https://secure.php.net/manual/pt_BR/index.php"&gt;php&lt;/a&gt;. As vezes é necessário desenvolver novas features nessas aplicações, para que elas possam se comunicar com outra aplicação.&lt;/p&gt;
&lt;h4&gt;Vamos ao que realmente interessa #nodejs.&lt;/h4&gt;
&lt;p&gt;Eu não tive muita dificuldade para entender &lt;a href="https://nodejs.org/en/"&gt;nodejs&lt;/a&gt;, eu já sabia javascript muito bem, então foi fácil para dar meus primeiros passos. A unica coisa que me atrapalhou um pouco nesse projeto foi montar a minha stack, o &lt;a href="https://nodejs.org/en/"&gt;nodejs&lt;/a&gt; possui várias implementações para o que eu estava querendo fazer. Mas conversando com amigos mais fluentes em &lt;a href="https://nodejs.org/en/"&gt;nodejs&lt;/a&gt; eu cheguei ao meu produto, uma api para me informar o valor dos proventos pagos por cada &lt;a href="http://www.fundoimobiliario.com.br/"&gt;fundo imobiliário&lt;/a&gt;. Se quiser já ir dando uma olhada o &lt;a href="https://github.com/riquellopes/fii"&gt;link&lt;/a&gt; é esse. Eu vou explicar todo o processo, pode deixar. Vou te dar tudo no esquema.&lt;/p&gt;
&lt;p&gt;Eu tentei encontrar alguma api que podesse me fornecer a informação que eu queria, mas não achei nada que fosse de graça. Então acabei criando um &lt;a href="https://pt.wikipedia.org/wiki/Data_scraping"&gt;scraping&lt;/a&gt;, que raspa essa informação de um outro site. Em python isso é muito tranquilo de se fazer. Com &lt;a href="http://www.crummy.com/software/BeautifulSoup/"&gt;BeautifulSoup&lt;/a&gt; e &lt;a href="http://docs.python-requests.org/en/latest/"&gt;requests&lt;/a&gt;, eu teria isso de forma simples. No &lt;a href="https://nodejs.org/en/"&gt;nodejs&lt;/a&gt; eu utilizei o &lt;a href="https://www.npmjs.com/package/scrap"&gt;scrap&lt;/a&gt;, li vários posts que mencionavam ele, então resolvi usar. Para quem já usou jQuery, e sabe um pouco de &lt;a href="https://api.jquery.com/category/selectors/"&gt;seletores&lt;/a&gt;, não vai encontrar nenhuma dificuldade para utilizar.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="nx"&gt;exports&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;scrap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
    &lt;span class="nx"&gt;scrap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;config&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;endpoint&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Serviço indisponível.&amp;quot;&lt;/span&gt;
          &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="nx"&gt;err&lt;/span&gt; &lt;span class="p"&gt;){&lt;/span&gt;
              &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;status&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;503&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;
          &lt;span class="p"&gt;}&lt;/span&gt;

          &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;queue&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;async&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;queue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
              &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
          &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

          &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;table&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
              &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;tr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;table&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
              &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                  &lt;span class="nx"&gt;codigo&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;td&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                  &lt;span class="nx"&gt;data_base&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;td&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                  &lt;span class="nx"&gt;cotacao_base&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;td&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                  &lt;span class="nx"&gt;data_pagamento&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;td&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                  &lt;span class="nx"&gt;valor_rendimento&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;td&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                  &lt;span class="nx"&gt;porcentagem_rendimento&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;td&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                  &lt;span class="nx"&gt;observacao&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;td&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
              &lt;span class="p"&gt;}&lt;/span&gt;

              &lt;span class="nx"&gt;queue&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;Fii&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;doc&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
                  &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
                      &lt;span class="nx"&gt;queue&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;kill&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
                      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;status&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                          &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Erro ao importar as informações.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;
                  &lt;span class="p"&gt;}&lt;/span&gt;
              &lt;span class="p"&gt;});&lt;/span&gt;
          &lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="c1"&gt;// for&lt;/span&gt;

          &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;queue&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
              &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;status&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;503&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;
          &lt;span class="p"&gt;}&lt;/span&gt;

          &lt;span class="nx"&gt;queue&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;drain&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
              &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                  &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;util&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                      &lt;span class="s2"&gt;&amp;quot;%s fii, foram copiados.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))});&lt;/span&gt;
          &lt;span class="p"&gt;};&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para acelerar um pouco mais o processo, eu utilizei um queue do módulo, &lt;a href="https://github.com/caolan/async"&gt;async&lt;/a&gt;. Eu não tinha tanta necessidade de fazer isso, mais como era um protótipo, resolvi adicionar essa fila, para que o meu processo fosse mais performático ainda. O módulo &lt;a href="https://github.com/caolan/async"&gt;async&lt;/a&gt; possui várias features legais, da uma olhada depois na documentação do projeto.&lt;/p&gt;
&lt;h4&gt;Orm utilizado.&lt;/h4&gt;
&lt;p&gt;Para persistir esses dados, que não possuem uma estrutura muito bem definida eu resolvi utilizar o &lt;a href="https://www.mongodb.org/"&gt;mongodb&lt;/a&gt;+&lt;a href="https://mongolab.com/"&gt;mongolab&lt;/a&gt;+&lt;a href="http://mongoosejs.com/"&gt;mongoose&lt;/a&gt;.
Nas pesquisas que fiz o &lt;a href="http://mongoosejs.com/"&gt;mongoose&lt;/a&gt; é muito difundido, então segui essa mesma linha. O &lt;a href="https://mongolab.com/"&gt;mongolab&lt;/a&gt; é um MongoDB-as-a-Service que eu gosto muito, e como eu não queria pagar nada para ter uma máquina com &lt;a href="https://www.mongodb.org/"&gt;mongodb&lt;/a&gt;, adicionei mais esse ingrediente a minha stack.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;FiiSchema&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;Schema&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="nx"&gt;codigo&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;required&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;unique&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="nx"&gt;data_base&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;cotacao_base&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;data_pagamento&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;valor_rendimento&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;porcentagem_rendimento&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;baixa_liquides&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;Boolean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;investidor_qualificado&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;Boolean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;observacao&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;created&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;now&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;

&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;fii&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;module&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;exports&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;mongoose&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;model&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Fii&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;FiiSchema&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="nx"&gt;FiiSchema&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pre&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;save&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;next&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;investidor_qualificado&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;codigo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;*IQ*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;baixa_liquides&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;codigo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;*BL*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;codigo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;codigo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="nx"&gt;next&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Você pode perceber que utilizei um feature do mongoose, &lt;a href="http://mongoosejs.com/docs/middleware.html"&gt;pre save&lt;/a&gt;, pois antes que ele persiste a informação, eu precisava que algumas coisas fossem extraidas. Pra quem já usou o &lt;a href="https://www.djangoproject.com"&gt;django&lt;/a&gt; alguma vez, já deve ter esbarrado com &lt;a href="https://docs.djangoproject.com/en/1.9/ref/signals/"&gt;signals&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;Aplicação sem test não tem graça.&lt;/h4&gt;
&lt;p&gt;Uma das coisas que mais me auxiliam a criar aplicações, sem ter medo de errar, é sempre ter testes para
garantir que minha aplicacação vai fazer exatamente aquilo para qual ela foi criada. Para minha stack de teste eu utilizei,
&lt;a href="https://www.npmjs.com/package/supertest"&gt;supertest&lt;/a&gt;+&lt;a href="https://www.npmjs.com/package/assert"&gt;assert&lt;/a&gt;+&lt;a href="https://www.npmjs.com/package/nock"&gt;nock&lt;/a&gt;+&lt;a href="https://github.com/mochajs/mocha"&gt;mocha&lt;/a&gt;.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="nx"&gt;describe&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;SCRAP&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
    &lt;span class="nx"&gt;before&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
        &lt;span class="nx"&gt;Fii&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(){});&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;

    &lt;span class="nx"&gt;it&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;should return {message:&amp;#39;94 fii, foram copiados.&amp;#39;}.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
        &lt;span class="nx"&gt;nock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;config&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;endpoint&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;once&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;reply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;uri&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;requestBody&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;cb&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
                &lt;span class="nx"&gt;fs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;readFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;__dirname&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/index.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;cb&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
        &lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;app&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/api/scrap&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;expect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;end&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="nx"&gt;error&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

                &lt;span class="nx"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;equal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;94 fii, foram copiados.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;

    &lt;span class="nx"&gt;it&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;fii service return 404, scrap service should return message and status 503.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
        &lt;span class="nx"&gt;nock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;config&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;endpoint&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;once&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;reply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;404&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Fora&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;app&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/api/scrap&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;expect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;503&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;end&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
                &lt;span class="nx"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;equal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Serviço indisponível.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;

    &lt;span class="nx"&gt;it&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;case html broken, scrap service should return status 503&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
        &lt;span class="nx"&gt;nock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;config&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;endpoint&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;once&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;reply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;uri&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;requestBody&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;cb&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
                &lt;span class="nx"&gt;fs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;readFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;__dirname&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/error.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;cb&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
        &lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;app&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/api/scrap&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;expect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;503&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;end&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
                &lt;span class="nx"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;equal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Serviço indisponível.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;O &lt;a href="https://www.npmjs.com/package/nock"&gt;nock&lt;/a&gt; só é necessário se você precisa &lt;a href="https://pt.wikipedia.org/wiki/Objeto_Mock"&gt;mockar&lt;/a&gt; alguma resposta.
Para testes que dependem de recursos externernos a sua aplicação, é interessante você &lt;a href="https://pt.wikipedia.org/wiki/Objeto_Mock"&gt;mockar&lt;/a&gt;, para performar o tempo de resposta do seus testes.
Os testes foram escritos em &lt;a href="https://pt.wikipedia.org/wiki/Behavior_Driven_Development"&gt;BDD&lt;/a&gt; utilizando o framework &lt;a href="https://github.com/mochajs/mocha"&gt;mocha&lt;/a&gt;, e para simular as chamadas ao serviço &lt;a href="https://www.npmjs.com/package/supertest"&gt;supertest&lt;/a&gt;. Para executar a stack de teste é bem simples.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;make &lt;span class="nb"&gt;test&lt;/span&gt;
or
npm &lt;span class="nb"&gt;test&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Desenvolvendo em ambientes seguros.&lt;/h4&gt;
&lt;p&gt;O último módulo é não menos importante que completou a minha stack, foi o &lt;a href="https://www.npmjs.com/package/dotenv"&gt;dotenv&lt;/a&gt;. Um site que eu indico para você ler, e ter uma melhor noção de boas práticas de software-as-a-service é &lt;a href="http://12factor.net"&gt;The Twelve-Factor APP&lt;/a&gt;. O tópico que ratifica
o uso desse módulo é o &lt;a href="http://12factor.net/config"&gt;III Config&lt;/a&gt;. O &lt;a href="https://www.npmjs.com/package/dotenv"&gt;dotenv&lt;/a&gt; permite que você crie enviroments com as configurações que você precisa no seu ambiente local. Ele não é para ser utilizado em produção. Por default ele vai procurar na raiz
do seu projeto a variável de ambiente &lt;strong&gt;.env&lt;/strong&gt;, caso você queira usar outro nome, você precisa passar o &lt;a href="https://www.npmjs.com/package/dotenv#path"&gt;path&lt;/a&gt; para &lt;a href="https://www.npmjs.com/package/dotenv"&gt;dotenv&lt;/a&gt;, não é nenhum bicho de 7 cabeças.&lt;/p&gt;
&lt;h4&gt;Express em ação.&lt;/h4&gt;
&lt;p&gt;Criar uma aplicação com &lt;a href="http://expressjs.com/"&gt;express&lt;/a&gt; é bem simples, ele não foge muito do
modelo que o &lt;a href="http://flask.pocoo.org/"&gt;flask&lt;/a&gt; nos da. Eu queria que o meu app, ficasse isolado
do contexto geral, e que de certa forma eu pudesse desplugar ele rapidamente da minha app. Então
eu usei a feature &lt;em&gt;express.Router()&lt;/em&gt; para me permitir fazer isso.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;express&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;express&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;config&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;./config&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;mongoose&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;mongoose&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;api&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;./models/api.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;exports&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;express&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;PORT&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="mi"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nx"&gt;router&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;express&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Router&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="nx"&gt;router&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;api&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;list&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nx"&gt;router&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/scrap&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;api&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;scrap&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nx"&gt;router&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/:codigo&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;api&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nx"&gt;app&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;json spaces&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nx"&gt;app&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;use&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/api&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;router&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="nx"&gt;app&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
    &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Recupera informações sobre proventos dos fii&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;

&lt;span class="nx"&gt;app&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;listen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;port&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para executar app, basta executar o commando abaixo.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;make run
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Conclusão.&lt;/h4&gt;
&lt;p&gt;Espero que tenha atendido as suas expectativas. Dúvidas ou sugestões é só comentar no post, que eu
estou sempre a disposição para ajudar. Não fique acanhado em fazer um &lt;a href="https://help.github.com/articles/fork-a-repo/"&gt;fork&lt;/a&gt; e me mandar um &lt;a href="https://help.github.com/articles/using-pull-requests/"&gt;pull request&lt;/a&gt; com uma melhoria no app.&lt;/p&gt;</summary><category term="nodejs"></category><category term="express"></category><category term="api"></category></entry><entry><title>Como testar a velocidade da sua internet com Python</title><link href="http://blog.henriquelopes.com.br/como-testar-a-velocidade-da-sua-internet-com-python.html" rel="alternate"></link><updated>2016-01-21T09:30:00-02:00</updated><author><name>Henrique Lopes</name></author><id>tag:blog.henriquelopes.com.br,2016-01-21:como-testar-a-velocidade-da-sua-internet-com-python.html</id><summary type="html">&lt;p&gt;Python sempre me surpreende por sua versatilidade e sua usabilidade. Resolvi buscar no &lt;a href="https://www.google.com.br/"&gt;google&lt;/a&gt; alguma lib python que eu pudesse utilizar para medir a velocidade da
internet da minha casa. E logo na primeira tacada me deparei com esse post: &lt;a href="http://www.raspberrypi-spy.co.uk/2015/03/measuring-internet-speed-in-python-using-speedtest-cli/"&gt;Measuring Internet Speed In Python Using Speedtest-cli&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Matt Martz que é o autor do projeto, criou uma &lt;a href="https://www.techopedia.com/definition/3337/command-line-interface-cli"&gt;interface cli&lt;/a&gt;, utilizando o serviço &lt;a href="http://www.speedtest.net"&gt;speedtest.net&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;Instalando&lt;/h4&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;pip install speedtest-cli
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Executando SpeedTest&lt;/h4&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;speedtest
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Esse foi o meu resultado.&lt;/p&gt;
&lt;p&gt;&lt;img alt="ScreeShot" src="//res.cloudinary.com/madeinhouse/image/upload/c_scale,w_680/v1453418830/screen-shot_m1pgrn.png" /&gt;&lt;/p&gt;
&lt;p&gt;O speedtest possui um feature bem legal, na qual você pode passar o parâmetro -share para o programa,
e ele vai criar uma imagem online do seu resultado, que você pode compartilhar com seus amigos.&lt;/p&gt;
&lt;p&gt;No &lt;a href="https://github.com/sivel/speedtest-cli"&gt;github do projeto&lt;/a&gt; você vai encontrar mais informações sobre
como você pode utilizar.&lt;/p&gt;</summary><category term="python"></category><category term="ferramenta"></category></entry><entry><title>Como fazer seu primeiro deploy no Heroku</title><link href="http://blog.henriquelopes.com.br/como-fazer-seu-primeiro-deploy-no-heroku.html" rel="alternate"></link><updated>2016-01-17T17:48:00-02:00</updated><author><name>Henrique Lopes</name></author><id>tag:blog.henriquelopes.com.br,2016-01-17:como-fazer-seu-primeiro-deploy-no-heroku.html</id><summary type="html">&lt;p&gt;Semana passada eu mostrei como era simples você criar o seu primeiro app web com Python,
&lt;a href="http://blog.henriquelopes.com.br/simples-flask-app.html"&gt;simples flask app&lt;/a&gt;. Hoje eu quero ir além,
você já deve ter visto alguns posts em inglês ou em português, de como fazer o seu primeiro deploy no &lt;a href="https://www.heroku.com/"&gt;Heroku&lt;/a&gt;. É simples! Como o Flask é o meu coringa pra quando eu preciso desenvolver algo simples, o &lt;a href="https://www.heroku.com/"&gt;Heroku&lt;/a&gt; é o meu parque de diversões. Onde eu posso simplesmente com um git push, ter a minha aplicação em produção. Com o tempo, fazendo a mesma coisa, eu resolvi criar uma extensão para o &lt;a href="http://flask.pocoo.org/"&gt;Flask&lt;/a&gt;: o &lt;a href="https://github.com/riquellopes/boot-flask"&gt;BootFlask&lt;/a&gt;. Com ele você cria uma aplicação simples, e ganha algum tempo para fazer o que realmente importa. Mas vamos ao que interessa.&lt;/p&gt;
&lt;h4&gt;Primeiro passo - Montar o ambiente:&lt;/h4&gt;
&lt;p&gt;No último post eu mostrei para vocês o benefício que você tem em usar a ferramenta &lt;a href="https://virtualenv.readthedocs.org/en/latest/"&gt;virtualenv&lt;/a&gt;, se tiver alguma duvida, volta lá no &lt;a href="http://blog.henriquelopes.com.br/simples-flask-app.html"&gt;post&lt;/a&gt; e depois volte aqui. Dessa vez eu vou adicionar mais baterias nesse app eu vou usar o &lt;a href="https://virtualenvwrapper.readthedocs.org/en/latest/"&gt;virtualenvwrapper&lt;/a&gt; para ficar mais fácil ainda. Qualquer duvida é só comentar que eu te explicarei. Mais básicamente o &lt;a href="https://virtualenvwrapper.readthedocs.org/en/latest/"&gt;virtualenvwrapper&lt;/a&gt; cria uma camada em cima do &lt;a href="https://virtualenv.readthedocs.org/en/latest/"&gt;virtualenv&lt;/a&gt; e cria novos comandos para facilitar o seu dia a dia.
Os comandos que eu vou utilizar abaixo, são comandos do &lt;a href="https://virtualenvwrapper.readthedocs.org/en/latest/"&gt;virtualenvwrapper&lt;/a&gt;. Em breve vou escrever um novo post, para falar sobre isso.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;mkvirtualenv hello-heroku
pip install https://github.com/riquellopes/boot-flask/tarball/master
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Criando meu primeiro projeto com BootFlask:&lt;/h4&gt;
&lt;p&gt;Para criar um novo projeto com &lt;a href="https://github.com/riquellopes/boot-flask"&gt;BootFlask&lt;/a&gt; você deve executar o bootflask com o argumento -p.
O -p é utilizado para informar o nome do projeto, após executar esse comando, a arquitetura básica de arquivos é criada.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;bootflask -p hello-heroku
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ainda faltam alguns arquivos, um deles é o requirements.txt, esse arquivo é utilizado pelo &lt;a href="https://www.heroku.com/"&gt;Heroku&lt;/a&gt; para indentificar quais pacotes do seu projeto Python, precisam ser instalados. O &lt;a href="https://pip.pypa.io/en/stable/reference/pip_freeze/#id4"&gt;freeze&lt;/a&gt; é o comando do gerenciador de pacotes pip, para recuperar todos os pacotes que seu environment possui, quando você executar o comando pip freeze &amp;gt; requirements.txt, ele vai pegar todo o output e escrever no arquivo requirements.txt. Após criar o requirements.txt abra o arquivo, no editor de sua preferência, e remova o BootFlask==0.1 do arquivo, você não vai precisar dele no &lt;a href="https://www.heroku.com/"&gt;Heroku&lt;/a&gt;.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;pip freeze

&lt;span class="nv"&gt;Flask&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;0.10.1
&lt;span class="nv"&gt;itsdangerous&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;0.24
&lt;span class="nv"&gt;Jinja2&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;2.8
&lt;span class="nv"&gt;MarkupSafe&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;0.23
&lt;span class="nv"&gt;Werkzeug&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;0.11.3
&lt;span class="nv"&gt;wheel&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;0.24.0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Se você ainda não tiver iniciado o git para seu projeto, faça isso agora com o comando &lt;a href="https://git-scm.com/docs/git-init"&gt;git init&lt;/a&gt;, é bem simples. E você já pode fazer seu primeiro &lt;a href="https://git-scm.com/docs/git-commit"&gt;commit&lt;/a&gt;.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;git init
git add -A
git commit -am &lt;span class="s2"&gt;&amp;quot;iniciando app.&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Segundo passo - Criando a sua aplicação na interface do Heroku&lt;/h4&gt;
&lt;p&gt;A interface no Heroku é muito intuitiva e você não vai encontrar grandes problemas para criar um novo projeto.
Após sua autenticação no Heroku, basta você clicar em create app,
&lt;img alt="Create new app" src="//res.cloudinary.com/madeinhouse/image/upload/c_scale,w_780/v1453126089/create-new-app_mqevjw.png" title="Create new App" /&gt;&lt;/p&gt;
&lt;p&gt;Após você clicar em create app, você será encaminhado para a tela abaixo. o campo App Name não é obrigatório,
mas se você quiser dar um nome legal para a sua aplicação fique a vontade.
&lt;img alt="Create app" src="http://res.cloudinary.com/madeinhouse/image/upload/c_scale,w_780/v1453126092/create-app_ciuxw3.png" title="Create App" /&gt;&lt;/p&gt;
&lt;p&gt;Depois dessa difícil tarefa, você será levado para a ultima tela, onde você receberá algumas instruções que você deve executar na sua máquina. Se você não possui o &lt;a href="https://toolbelt.heroku.com/"&gt;Heroku ToolBelt&lt;/a&gt;, esse é um bom momento para instalar.
&lt;img alt="Deploy you changes" src="http://res.cloudinary.com/madeinhouse/image/upload/c_scale,w_780/v1453126097/deploy-your-changes_gaeoyq.png" title="Deploy you changes" /&gt;&lt;/p&gt;
&lt;h4&gt;Terceiro passo - Configurando variáveis locais e fazendo seu primeiro deploy:&lt;/h4&gt;
&lt;p&gt;O &lt;a href="https://www.heroku.com/"&gt;Heroku&lt;/a&gt; utiliza do &lt;a href="https://git-scm.com/docs/git-push"&gt;git push&lt;/a&gt; para fazer o deploy da sua aplicação, não tem nada de complicado nisso, a única coisa que você precisa fazer é configurar o seu &lt;a href="https://git-scm.com/docs/git-remote"&gt;remote&lt;/a&gt;, o &lt;a href="https://toolbelt.heroku.com/"&gt;Heroku ToolBelt&lt;/a&gt; possui um alias para isso, vamos executar esse comando agora.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;heroku git:remote -a O_NOME_DO_APP_DEVE_SER_ADICIONADO_AQUI
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Esse é o unico comando que precisa ser executado na sua máquina, para partir para o deploy. E vamos fazer isso agora mesmo!&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;git push
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;E num passe de mágica a sua aplicação está me produção. Acho que não poderia ter um jeito mais fácil de fazer isso. Como eu sempre preso pelo "show me the code", ai estão os meus:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://mighty-stream-1291.herokuapp.com"&gt;Projeto em produção&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/riquellopes/hello-heroku"&gt;Código do projeto&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="flask"></category><category term="python"></category><category term="heroku"></category><category term="deploy"></category></entry><entry><title>Simples Flask App</title><link href="http://blog.henriquelopes.com.br/simples-flask-app.html" rel="alternate"></link><updated>2016-01-11T21:57:00-02:00</updated><author><name>Henrique Lopes</name></author><id>tag:blog.henriquelopes.com.br,2016-01-11:simples-flask-app.html</id><summary type="html">&lt;p&gt;Já sentiu vontade de criar uma simples aplicação web, mas se sentiu preso? Pois quando você via o número de
configurações que eram necessárias para fazer a sua aplicação apenas dar um Hello World, você já sentia que ia
demorar? Pois bem, o Python não é uma bala de prata, mas ele possui n &lt;a href="https://pt.wikipedia.org/wiki/Framework"&gt;frameworks&lt;/a&gt; e &lt;a href="https://en.wikipedia.org/wiki/Microframework"&gt;microframeworks&lt;/a&gt; que vão fazer você sentir prazer em gerar um simples Hello World.&lt;/p&gt;
&lt;p&gt;Hoje eu quero apresentar um microframework muito conhecido e já difundido na comunidade Python, o &lt;a href="http://flask.pocoo.org/"&gt;Flask&lt;/a&gt; que pela sua simplicidade e robustez, merece ser o meu primeiro post hands on.
E, para adicionar mais baterias ao nosso App, vamos falar um pouco de &lt;a href="https://virtualenv.readthedocs.org/en/latest/"&gt;virtualenv&lt;/a&gt;.&lt;/p&gt;
&lt;h5&gt;Primeiro Passo - Montar o ambiente:&lt;/h5&gt;
&lt;p&gt;Se você usa &lt;a href="https://pt.wikipedia.org/wiki/Linux"&gt;Linux&lt;/a&gt; ou &lt;a href="https://pt.wikipedia.org/wiki/OS_X"&gt;Macosx&lt;/a&gt; seguir esse post será muito tranquilo. Se você usa &lt;a href="https://pt.wikipedia.org/wiki/Microsoft_Windows"&gt;Windows&lt;/a&gt;, eu vou escrever um outro post só para ajudar você.&lt;/p&gt;
&lt;p&gt;Abra o terminal e siga os passos abaixo:&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;pip install virtualenv
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Porque não instalar logo o Flask, e partir para o que realmente interessa? Se você teve a curiosidade de abrir o link do &lt;a href="https://virtualenv.readthedocs.org/en/latest/"&gt;virtualenv&lt;/a&gt; e dar uma lida, você já sabe o porque e para que eu iniciei esse app instalando essa lib. O que eu quero fixar na sua mente de uma forma bem simples, é que no mundo real em uma empresa web ou de qualquer ramo da tecnologia, você vai ter a necessidade de trabalhar com várias versões de Python no seu dia a dia. Cada app ou projeto que você for trabalhar, vão possuir características que irão exigir que você possua várias versões de Python na sua máquina. O &lt;a href="https://virtualenv.readthedocs.org/en/latest/"&gt;virturalenv&lt;/a&gt; vai permitir que você possua, para cada projeto, uma versão de Python diferente, sem precisar instalar nada no Python nativo do seu sistema. E sem deixar passar despercebido, eu estou usando o gerenciador de pacote do Python o &lt;a href="https://docs.python.org/3.6/installing/index.html"&gt;pip&lt;/a&gt;, com ele você irá instalar todos pacotes de python que o seu app precisa.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;virtualenv /tmp/hello_world
&lt;span class="nb"&gt;source&lt;/span&gt; /tmp/hello_world/bin/activate

pip install flask
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Eu não vou entrar no mérito dos comandos executados com o virtualenv, até porque a documentação explica muito bem isso. Mas logo logo eu escrevo um post, para te deixar a par.&lt;/p&gt;
&lt;h4&gt;Segundo passo - Escrever o app:&lt;/h4&gt;
&lt;p&gt;Após criar o nosso ambiente, vamos criar o nosso app. Geralmente eu crio uma pasta, então se quiser, pode fazer o mesmo. Comando executados &lt;a href="http://www.linfo.org/mkdir.html"&gt;mkdir&lt;/a&gt;, &lt;a href="http://www.linfo.org/cd.html"&gt;cd&lt;/a&gt;, &lt;a href="http://www.linfo.org/touch.html"&gt;touch&lt;/a&gt; são comandos bem comuns para quem já do mundo opensource. Você pode clicar em cada uma deles para obter uma descrição melhor. O último comando executando o "atom" pode ser novidade para você, mais ele é um alias para o editor &lt;a href="https://atom.io/"&gt;Atom&lt;/a&gt;. Fique à vontade para usar o editor da sua preferência.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;mkdir hello-world
&lt;span class="nb"&gt;cd &lt;/span&gt;hello-world
touch app.py
atom app.py
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Quando eu escrevi essas linhas de código pela primeira vez, eu fiquei impressionado com a simplicidade que era para escrever uma aplicação. Cada linguagem tem o seu paradigma, mas o Python me surpreende com a sua simplicidade. Com apenas as 9 linhas de código abaixo a sua aplicação está pronta para ser executada.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nd"&gt;@app.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;home&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;HelloWorld&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="codehilite"&gt;&lt;pre&gt;python app.py
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Terceiro passo:&lt;/h4&gt;
&lt;p&gt;Esse é o passo mais importante. Não pare de aprender e compartilhar.&lt;/p&gt;</summary><category term="python"></category><category term="flask"></category><category term="dev"></category></entry><entry><title>Início de tudo</title><link href="http://blog.henriquelopes.com.br/inicio-de-tudo.html" rel="alternate"></link><updated>2016-01-20T09:05:00-02:00</updated><author><name>Henrique Lopes</name></author><id>tag:blog.henriquelopes.com.br,2015-12-28:inicio-de-tudo.html</id><summary type="html">&lt;p&gt;Enfim decidi começar a escrever, compartilhar experiências e pensamentos.
Esse espaço não será destinado apenas para falar sobre tecnologia, existem outras coisas que eu gosto de fazer, e
vou passar a compartilhar aqui. Empreendedorismo, música, mercado financeiro, minha loja de usados,
aqui existe espaço para tudo.&lt;/p&gt;
&lt;p&gt;O que eu sempre tive vontade de fazer, era retornar para a comunidade tudo que ela me proporcionou.
A maioria das coisas que eu aprendi, não foram sentado nas carteiras de uma faculdade, mas sim conversando com pessoas, ouvindo na maioria das vezes! As sessões de &lt;a href="http://dojorio.org/"&gt;dojo&lt;/a&gt;, foram fundamentais para me transformar em um programdor poliglota, a cada sessão eu estava um pouco mais forte.&lt;/p&gt;
&lt;p&gt;Esse espaço também vai ser útil para pessoas que assim como eu, um dia não tiveram recurso para pagar
pelo conhecimento. Aqui eu vou compartilhar links de coisas que leio e acho interessante,
as vezes podem ser áudios também. O importante é o conhecimento não ficar em uma única mão, ele deve
circular. Se tiver alguma coisa errada pode criticar, isso faz parte do meu aprendizado.&lt;/p&gt;</summary><category term="usados"></category><category term="empreendedorismo"></category><category term="musica"></category></entry></feed>